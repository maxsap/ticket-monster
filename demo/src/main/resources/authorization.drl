package org.picketbox.drools.authorization;

import java.security.Principal;
import org.picketbox.http.authorization.resource.WebResource;

dialect "mvel"

rule "Normal User Authorization Rule"
dialect "java"
no-loop
 when
  $principal : Principal( name == "guest" ) // condition
  $resource : WebResource(!getRequest().getRequestURI().contains("/admin"))
 then
    modify ($resource){
       setAuthorized(true)
    };
end

rule "Administrators Authorization Rule"
dialect "java"
no-loop
 when
  $principal : Principal( name == "admin" ) // condition
  $resource : WebResource()
 then
    modify ($resource){
       setAuthorized(true)
    };
end