<beans
	xmlns="http://java.sun.com/xml/ns/javaee"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:s="urn:java:ee"
	xmlns:mail="urn:java:org.jboss.seam.mail.core"
	xmlns:pbhttpauth="urn:java:org.picketbox.http.authentication"
	xmlns:pbhttpr="urn:java:org.picketbox.http.resource"
	xmlns:pbr="urn:java:org.picketbox.http.resource"
	xmlns:pbauthmgr="urn:java:org.picketbox.core.authentication.manager"
	xmlns:pbs="urn:java:org.picketbox.solder.authentication"
	xmlns:pbauthzd="urn:java:org.picketbox.drools.authorization"
	xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://docs.jboss.org/cdi/beans_1_0.xsd">
	
	<!-- Configures a HTTPFormAuthentication bean -->
	<pbhttpauth:HTTPFormAuthentication>
		<s:replaces/>
		<pbs:AuthenticationScheme/>
		<pbhttpauth:formAuthPage>
			<s:value>/faces/login.xhtml</s:value>
		</pbhttpauth:formAuthPage>
	</pbhttpauth:HTTPFormAuthentication>
	
	<pbauthmgr:PropertiesFileBasedAuthenticationManager/>
		
	<!-- Configures the PicketBox Drools Authorization Manager -->
	<pbauthzd:PicketBoxDroolsAuthorizationManager/>
	
	<pbhttpr:HTTPProtectedResourceManager>
		<s:replaces/>
		<pbhttpr:resources>
			<s:value>
				<pbr:ProtectedResource pattern="/resources/*" constraint="NOT_PROTECTED" />
			</s:value>
			<s:value>
				<pbr:ProtectedResource pattern="/*.css" constraint="NOT_PROTECTED" />
			</s:value>
			<s:value>
				<pbr:ProtectedResource pattern="/picketbox_logout" constraint="AUTHENTICATION" />
			</s:value>
			<s:value>
				<pbr:ProtectedResource pattern="/admin/*" constraint="ALL">
					<pbr:roles>
						<s:value>admin</s:value>
					</pbr:roles>
				</pbr:ProtectedResource>
			</s:value>
		</pbhttpr:resources>
	</pbhttpr:HTTPProtectedResourceManager>
	
</beans>